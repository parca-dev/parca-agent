x-google-marketplace:
  schemaVersion: v2
  applicationApiVersion: v1beta1
  # The published version is required and MUST match the tag
  # of the deployer image
  publishedVersion: '0.45.1'
  publishedVersionMetadata:
    releaseNote: >-
      Initial release of Parca Agent for Google Cloud Marketplace.
      Parca Agent is an always-on sampling profiler that uses eBPF to capture
      raw profiling data with very low overhead.
    releaseTypes:
    - Feature
    recommended: true
  images:
    'parca-agent':
      properties:
        imageRepo:
          type: REPO_WITH_REGISTRY
        imageTag:
          type: TAG
  deployerServiceAccount:
    description: >-
      The deployer service account requires cluster-level permissions to create
      ClusterRole and ClusterRoleBinding resources for Parca Agent.
    roles:
    - type: ClusterRole
      rulesType: CUSTOM
      rules:
      - apiGroups: ['rbac.authorization.k8s.io']
        resources: ['clusterroles', 'clusterrolebindings']
        verbs: ['*']

properties:
  name:
    type: string
    x-google-marketplace:
      type: NAME
  namespace:
    type: string
    x-google-marketplace:
      type: NAMESPACE
  remoteStoreAddress: 
    type: string
    title: The URL to the gRPC server ingesting parca-agent profiles
    default: ""
  offlineModeStoragePath: 
    type: string
    title: The path where to store the profiles in offline mode.
    default: /tmp
  bearerToken:
    type: string
    title: Bearer Token
    description: >-
      Optional bearer token for authenticating with the remote Parca server.
      Leave empty if your Parca server does not require authentication.
    x-google-marketplace:
      type: MASKED_FIELD

required:
- name
- namespace
- remoteStoreAddress

